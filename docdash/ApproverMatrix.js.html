<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>ApproverMatrix.js - Documentation</title>

    <script src="scripts/prettify/prettify.js"></script>
    <script src="scripts/prettify/lang-css.js"></script>
    <script src="scripts/jquery.js"></script>
    <script src="scripts/rawdeflate.js"></script>
    <script src="scripts/jquery_plantuml.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc.css">
</head>
<body>

<input type="checkbox" id="nav-trigger" class="nav-trigger" />
<label for="nav-trigger" class="navicon-button x">
  <div class="navicon"></div>
</label>

<label for="nav-trigger" class="overlay"></label>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Classes</h3><ul><li><a href="ExportPricePlan.html">ExportPricePlan</a><ul class='methods'><li data-type='method'><a href="ExportPricePlan.html#BuildObjectForReport">BuildObjectForReport</a></li><li data-type='method'><a href="ExportPricePlan.html#BuildReport">BuildReport</a></li><li data-type='method'><a href="ExportPricePlan.html#BuildReportDataFromUI">BuildReportDataFromUI</a></li><li data-type='method'><a href="ExportPricePlan.html#fetchPricePlan">fetchPricePlan</a></li><li data-type='method'><a href="ExportPricePlan.html#getCSVData">getCSVData</a></li><li data-type='method'><a href="ExportPricePlan.html#getReport">getReport</a></li><li data-type='method'><a href="ExportPricePlan.html#initModule">initModule</a></li></ul></li><li><a href="WebUI.PricePlanBestPracticesManager.html">PricePlanBestPracticesManager</a><ul class='methods'><li data-type='method'><a href="WebUI.PricePlanBestPracticesManager.html#evalBestPractice">evalBestPractice</a></li><li data-type='method'><a href="WebUI.PricePlanBestPracticesManager.html#initializeModuleObjects">initializeModuleObjects</a></li><li data-type='method'><a href="WebUI.PricePlanBestPracticesManager.html#lookupChildForBestPractices">lookupChildForBestPractices</a></li><li data-type='method'><a href="WebUI.PricePlanBestPracticesManager.html#lookupForAvgBestPractice">lookupForAvgBestPractice</a></li><li data-type='method'><a href="WebUI.PricePlanBestPracticesManager.html#lookupGridForBestPractice">lookupGridForBestPractice</a></li><li data-type='method'><a href="WebUI.PricePlanBestPracticesManager.html#show">show</a></li></ul></li><li><a href="WebUI.PricePlanFinderManager.html">PricePlanFinderManager</a></li><li><a href="WF_NS_PS_Generic.html">WF_NS_PS_Generic</a><ul class='methods'><li data-type='method'><a href="WF_NS_PS_Generic.html#.ApprovalDecision_NodeEnter">ApprovalDecision_NodeEnter</a></li><li data-type='method'><a href="WF_NS_PS_Generic.html#.ApprovalDecision_NodeEnter_Execute">ApprovalDecision_NodeEnter_Execute</a></li><li data-type='method'><a href="WF_NS_PS_Generic.html#.Approved_NodeEnter">Approved_NodeEnter</a></li><li data-type='method'><a href="WF_NS_PS_Generic.html#.Approved_NodeEnter_Execute">Approved_NodeEnter_Execute</a></li><li data-type='method'><a href="WF_NS_PS_Generic.html#.Approved_TaskEnd">Approved_TaskEnd</a></li><li data-type='method'><a href="WF_NS_PS_Generic.html#.Approved_TaskEnd_Execute">Approved_TaskEnd_Execute</a></li><li data-type='method'><a href="WF_NS_PS_Generic.html#.GetPriceStructure">GetPriceStructure</a></li><li data-type='method'><a href="WF_NS_PS_Generic.html#.GetRolesFromBRMS_ExternalInterface">GetRolesFromBRMS_ExternalInterface</a></li><li data-type='method'><a href="WF_NS_PS_Generic.html#.InitializeBRMSInput">InitializeBRMSInput</a></li><li data-type='method'><a href="WF_NS_PS_Generic.html#.PendingApproval_NodeEnter">PendingApproval_NodeEnter</a></li><li data-type='method'><a href="WF_NS_PS_Generic.html#.PendingApproval_NodeEnter_Execute">PendingApproval_NodeEnter_Execute</a></li><li data-type='method'><a href="WF_NS_PS_Generic.html#.PendingApproval_TaskEnd">PendingApproval_TaskEnd</a></li><li data-type='method'><a href="WF_NS_PS_Generic.html#.PendingApproval_TaskEnd_Execute">PendingApproval_TaskEnd_Execute</a></li><li data-type='method'><a href="WF_NS_PS_Generic.html#.PublishDecision_NodeEnter">PublishDecision_NodeEnter</a></li><li data-type='method'><a href="WF_NS_PS_Generic.html#.PublishDecision_NodeEnter_Execute">PublishDecision_NodeEnter_Execute</a></li><li data-type='method'><a href="WF_NS_PS_Generic.html#.PublishDecision_NodeEnter_FetchNotifiers">PublishDecision_NodeEnter_FetchNotifiers</a></li></ul></li></ul><h3>Modules</h3><ul><li><a href="module-ApproverMatrix.html">ApproverMatrix</a></li><li><a href="module-CreatorMatrix.html">CreatorMatrix</a></li><li><a href="module-GWF_Normalize.html">GWF_Normalize</a><ul class='methods'><li data-type='method'><a href="module-GWF_Normalize.html#.GWF_Normalize">GWF_Normalize</a></li></ul></li><li><a href="module-WF_Execution.html">WF_Execution</a><ul class='methods'><li data-type='method'><a href="module-WF_Execution.html#.performWorkFlowTransitions">performWorkFlowTransitions</a></li><li data-type='method'><a href="module-WF_Execution.html#.WF_Execution">WF_Execution</a></li></ul></li><li><a href="module-WF_NS_PriceStructure.html">WF_NS_PriceStructure</a><ul class='methods'><li data-type='method'><a href="module-WF_NS_PriceStructure.html#.WF_NS_PriceStructure_createTaskForApprovalRoles">WF_NS_PriceStructure_createTaskForApprovalRoles</a></li><li data-type='method'><a href="module-WF_NS_PriceStructure.html#.WF_NS_PriceStructure_createTaskForPublisher">WF_NS_PriceStructure_createTaskForPublisher</a></li><li data-type='method'><a href="module-WF_NS_PriceStructure.html#.WF_NS_PriceStructure_getMaxSequence">WF_NS_PriceStructure_getMaxSequence</a></li><li data-type='method'><a href="module-WF_NS_PriceStructure.html#.WF_NS_PriceStructure_getNotificationUserString">WF_NS_PriceStructure_getNotificationUserString</a></li><li data-type='method'><a href="module-WF_NS_PriceStructure.html#.WF_NS_PriceStructure_getRecallRole">WF_NS_PriceStructure_getRecallRole</a></li><li data-type='method'><a href="module-WF_NS_PriceStructure.html#.WF_NS_PriceStructure_getRejectRole">WF_NS_PriceStructure_getRejectRole</a></li><li data-type='method'><a href="module-WF_NS_PriceStructure.html#.WF_NS_PriceStructure_getSubmitRole">WF_NS_PriceStructure_getSubmitRole</a></li><li data-type='method'><a href="module-WF_NS_PriceStructure.html#.WF_NS_PriceStructure_getSubmitRoleOnRejectionState">WF_NS_PriceStructure_getSubmitRoleOnRejectionState</a></li><li data-type='method'><a href="module-WF_NS_PriceStructure.html#~g_ExecuteWorkflowOperation">g_ExecuteWorkflowOperation</a></li></ul></li></ul><h3>Namespaces</h3><ul><li><a href="WebUI.html">WebUI</a></li><li><a href="Workflow.html">Workflow</a></li></ul>
</nav>

<div id="main">
    
    <h1 class="page-title">ApproverMatrix.js</h1>
    

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>/** 
 * @fileOverview This files contain Approver Matrix functions for BRMS Approver deployment
 * @author anadar
 * @version 1.0.0
 */


/**
 * @module ApproverMatrix
 */
importPackage(com.vistaar.docserver.util);
importPackage(org.json);
importPackage(java.lang);

/*

The script to add Approver Matrix
 */

var inpRoles = new org.json.JSONArray(docServerManager.getAllRolesDetails());
var BRMSConnector = VistaarJSUtils.getBRMSConnector(userConnInfo);

/*

Commenting out delete RuleBundles
var rulebundlesCodes= new Array ();
rulebundlesCodes[0] = "CWF_RB";
BRMSConnector.deleteRuleBundles(rulebundlesCodes) ;

var retVal = BRMSConnector.createRuleBundle("DOA_ApproverMatrix_RB","CWF_RB");
println("Returned Value is" + retVal);

var arrRuleSetName=[];

BRMSConnector.addRuleSet("DOA_ApproverMatrix_RB", "CWF_ApproverMatrix_DT");
BRMSConnector.addRuleSet("DOA_ApproverMatrix_RB", "Default Approver Setup");
BRMSConnector.addRuleSet("DOA_ApproverMatrix_RB", "CWF_Common");

*/

var ApproverMatrix = "CWF_ApproverMatrix_DT";
var creatorRuleSetObject = BRMSConnector.loadRuleSet(ApproverMatrix);

//println("\n\n\n\n=========creatorRuleSet"+creatorRuleSet);
var creatorRuleSetObjectJSON = new org.json.JSONObject(creatorRuleSetObject.toString());
creatorRuleSetObjectJSON.get("DecisionTableInfo").put("Data", []);

addToCreatorMatrix(inpRoles, creatorRuleSetObjectJSON);
var CreatorMatrixRuleSet = new com.vistaar.rules.dataObjects.RuleSet(creatorRuleSetObjectJSON.toString());
BRMSConnector.saveRuleSet(CreatorMatrixRuleSet);

var retVal = BRMSConnector.registerRules("DOA_ApproverMatrix_RB", 1, true);

println("Returned Value is" + retVal);

output = "success";

function addToCreatorMatrix(inpRoles, CreatorMatrix_DT) {
    try {
        var ruleSetData = JSON.parse(CreatorMatrix_DT.get("DecisionTableInfo").get("Data"));

        var l_inpRolesLen = inpRoles.length();
        var l_role = null;
        for (var roleItr = 0; roleItr &lt; l_inpRolesLen; roleItr++) {
            l_role = String(inpRoles.get(roleItr).get("roleName"));
            //if(l_role=="Administrator" || l_role=="ADMIN-ALL GEOGRAPHY-ALL")
            if (l_role == "ADMIN-ALL GEOGRAPHY-ALL") {
                var tempAP1 = ["PricePlan", "All Geography", "All Geography", "All Product", "All Product", true, "Level1", null, "", ""];
                var tempAP2 = ["PricePlan", "All Geography", "All Geography", "All Product", "All Product", true, "Level2", null, "", ""];
                var tempAP3 = ["PricePlan", "All Geography", "All Geography", "All Product", "All Product", true, "Level3", null, "", ""];
                tempAP1[8] = tempAP2[8] = tempAP3[8] = l_role;
                addRuleName(tempAP1, l_role);
                addRuleName(tempAP2, l_role);
                addRuleName(tempAP3, l_role);
                ruleSetData.push(tempAP1);
                ruleSetData.push(tempAP2);
                ruleSetData.push(tempAP3);
                createApprover(tempAP3[9], l_role);
                continue;
            }
            var l_roleSplitArr = l_role.split("-");
            var l_cust = l_roleSplitArr[0];

            if (l_cust == "AP1" || l_cust == "AP2" || l_cust == "AP3") {
                var geographyArr = l_roleSplitArr[1].split("_");
                var productArr = l_roleSplitArr[2].split("_");
                var geographyArrLen = geographyArr.length;
                var productArrLen = productArr.length;
                var l_ruleName;
                for (var geoItr = 0; geoItr &lt; geographyArrLen; geoItr++) {
                    var CreatorMatrixEntry = ["PricePlan", "", "", "", "", true, "", null, "", ""];
                    CreatorMatrixEntry[8] = l_role;
                    addLevel(CreatorMatrixEntry, l_cust);
                    addRuleName(CreatorMatrixEntry, l_role);
                    l_ruleName = CreatorMatrixEntry[9];
                    var geog = geographyArr[geoItr];
                    addGeography(CreatorMatrixEntry, geog);
                    for (var prodItr = 0; prodItr &lt; productArrLen; prodItr++) {
                        var finalCreatorMatrixEntry = JSON.parse(JSON.stringify(CreatorMatrixEntry));
                        var prod = productArr[prodItr];
                        addProduct(finalCreatorMatrixEntry, prod);
                        ruleSetData.push(finalCreatorMatrixEntry);
                    }
                }


                println("Creating Approver Ruleset");

                createApprover(l_ruleName, l_role);

            }
        }
        CreatorMatrix_DT.get("DecisionTableInfo").put("Data", ruleSetData);
    } catch (err) {
        println('Failed to delete Ruleset ' + err);
    }

}

function createApprover(p_ruleName, p_RoleName) {
    try {

        var isDeletedRuleSet = deleteDeleteRuleSet(p_ruleName);

        if (isDeletedRuleSet) {

            var conditionalRuleSet = BRMSConnector.createRuleSet(p_ruleName, p_ruleName, "Decision Table", "CWF_DOA_Template");

            var approver = fetchApproverRules(p_RoleName);

            println("Approver" + approver);

            println(conditionalRuleSet.toString());

            //var ruleSetData = JSON.parse(conditionalRuleSet.get("DecisionTableInfo").get("Data"));

            //conditionalRuleSet.get("DecisionTableInfo").get("Data").push(JSON.parse(approver));
            conditionalRuleSet.get("DecisionTableInfo").put("Data", JSON.parse(approver));

            conditionalRuleSet.put("Content", null);

            println(conditionalRuleSet.toString());

            var conditionalRuleSetObj = new com.vistaar.rules.dataObjects.RuleSet(conditionalRuleSet.toString());

            BRMSConnector.saveRuleSet(conditionalRuleSetObj);

            BRMSConnector.addRuleSet("DOA_ApproverMatrix_RB", p_ruleName);

        }
    } catch (err) {
        println('Failed to delete Ruleset ' + err);
    }
}

function deleteDeleteRuleSet(p_ruleName) {

    try {
        var arr = [];
        arr.push(p_ruleName);
        BRMSConnector.deleteRuleSets(arr);

        return true;
    } catch (err) {
        println('Failed to delete Ruleset ' + err);
        return false;
    }

}

function fetchApproverRules(p_RoleName) {
    try {
        var AP1 = '[["Level1","ROLENAME",null,null,null,null,null,null,null,null,null,null,null,null,"ROLENAME"]]';

        var AP2 = '[["Level2", "ROLENAME", "this.Level==\\"Deal\\" &amp;&amp; getDiffByType(this.Proposed.Net_FOB, this.Parent[this.Channels].MIN_NET_FOB_GUIDLINE, this.Parent[this.Channels].MIN_FOB_VS_GUIDANCE_THRESHOLD.UOM)", ">=", "this.Parent[this.Channels].MIN_FOB_VS_GUIDANCE_THRESHOLD[\\"Level 2\\"]", null, null, null, null, null, null, null, null, null, "Level2 Priceline NET FOB is below Min FOB guidance"],["Level2", "ROLENAME", "this.Level==\\"Deal\\" &amp;&amp; getDiffByType(this.Parent.Parent[this.Channels].AVG_FOB_PROPOSED_CALCULATED, this.Parent.Parent[this.Channels].AVG_FOB_GUIDLINE, this.Parent.Parent[this.Channels].AVG_FOB_VS_GUIDANCE_THRESHOLD.UOM)", ">=", "this.Parent.Parent[this.Channels].AVG_FOB_VS_GUIDANCE_THRESHOLD[\\"Level 2\\"]", null, null, null, null, null, null, null, null, null, "Level2 Avg. full year Net FOB at Pricecat level is below Avg FOB guidance"],["Level2", "ROLENAME", "this.Level==\\"Deal\\" &amp;&amp; getDiffByType(this.Parent.Parent[this.Channels].AVG_FOB_PROPOSED_CALCULATED, this.Parent.Parent[this.Channels].AVG_FOB_PREVIOUS_YEAR_CALCULATED, this.Parent.Parent[this.Channels].AVG_FOB_VS_PRIOR_YEAR_THRESHOLD.UOM)", ">=", "this.Parent.Parent[this.Channels].AVG_FOB_VS_PRIOR_YEAR_THRESHOLD[\\"Level 2\\"]", null, null, null, null, null, null, null, null, null, "Level2 Avg. full year Net FOB at Pricecat level is below Last Year"],["Level2", "ROLENAME", "this.Level==\\"Deal\\" &amp;&amp; getDiffByType(this.Proposed.Net_List_ATAX, this.Parent[this.Channels].MIN_NET_LIST_GUIDLINE, this.Parent[this.Channels].MIN_NETLIST_VS_GUIDANCE_THRESHOLD.UOM)", ">=", "this.Parent[this.Channels].MIN_NETLIST_VS_GUIDANCE_THRESHOLD[\\"Level 2\\"]", null, null, null, null, null, null, null, null, null, "Level2 NET List is below Min Net List guidance."],["Level2", "ROLENAME", "this.Level==\\"Deal\\" &amp;&amp; getDiffByType(this.Proposed.Net_FOB, this.Parent.Parent[this.Channels].MinCurrentNetFOB, this.Parent.Parent[this.Channels][\\"DEEPEST_FOB_THRESHOLD\\"].UOM)", ">=", "this.Parent.Parent[this.Channels][\\"DEEPEST_FOB_THRESHOLD\\"][\\"Level 2\\"]", null, null, null, null, null, null, null, null, null, "Level2 Proposed priceline is deeper (NET FOB) than any current."],["Level2", "ROLENAME", "this.Level==\\"Deal\\" &amp;&amp; getDiffByType(this.Proposed.Net_List_ATAX, this.Parent.Parent[this.Channels].MinCurrentNetList, this.Parent.Parent[this.Channels][\\"DEEPEST_NETLIST_THRESHOLD\\"].UOM)", ">=", "this.Parent.Parent[this.Channels][\\"DEEPEST_NETLIST_THRESHOLD\\"][\\"Level 2\\"]", null, null, null, null, null, null, null, null, null, "Level2 Proposed priceline is deeper Net List than any current."],["Level2", "ROLENAME", "this.Level==\\"Deal\\" &amp;&amp; getDiffByType(this.Proposed.RAB, this.Parent[this.Channels].MIN_RAB_GUIDLINE, this.Parent[this.Channels].MIN_RAB_VS_GUIDANCE_THRESHOLD.UOM)", ">=", "this.Parent[this.Channels].MIN_RAB_VS_GUIDANCE_THRESHOLD[\\"Level 2\\"]", null, null, null, null, null, null, null, null, null, "Level2 Priceline RAB is below guidance"],["Level2", "ROLENAME", "this.Level==\\"Deal\\" &amp;&amp; getDiffByType(this.Parent.Parent[this.Channels].AVG_FOB_PROPOSED_CALCULATED, this.Parent.Parent[this.Channels].AVG_FOB_CURRENT_CALCULATED, this.Parent.Parent[this.Channels].AVG_FOB_DECREASE_THRESHOLD.UOM)", ">=", "this.Parent.Parent[this.Channels].AVG_FOB_DECREASE_THRESHOLD[\\"Level 2\\"]", null, null, null, null, null, null, null, null, null, "Level2 Current FOB comparison"],["Level2", "ROLENAME", "this.Level==\\"Summary\\" &amp;&amp; this.isPermissionCheckOnly", "==", "true", null, null, null, null, null, null, null, null, null, "By Pass Threshold"]]';

        var AP3 = '[["Level3", "ROLENAME", "this.Level==\\"Deal\\" &amp;&amp; getDiffByType(this.Proposed.Net_FOB, this.Parent[this.Channels].MIN_NET_FOB_GUIDLINE, this.Parent[this.Channels].MIN_FOB_VS_GUIDANCE_THRESHOLD.UOM)", ">=", "this.Parent[this.Channels].MIN_FOB_VS_GUIDANCE_THRESHOLD[\\"Level 3\\"]", null, null, null, null, null, null, null, null, null, "Level3 Priceline NET FOB is below Min FOB guidance"],["Level3", "ROLENAME", "this.Level==\\"Deal\\" &amp;&amp; getDiffByType(this.Parent.Parent[this.Channels].AVG_FOB_PROPOSED_CALCULATED, this.Parent.Parent[this.Channels].AVG_FOB_GUIDLINE, this.Parent.Parent[this.Channels].AVG_FOB_VS_GUIDANCE_THRESHOLD.UOM)", ">=", "this.Parent.Parent[this.Channels].AVG_FOB_VS_GUIDANCE_THRESHOLD[\\"Level 3\\"]", null, null, null, null, null, null, null, null, null, "Level3 Avg. full year Net FOB at Pricecat level is below Avg FOB guidance"],["Level3", "ROLENAME", "this.Level==\\"Deal\\" &amp;&amp; getDiffByType(this.Parent.Parent[this.Channels].AVG_FOB_PROPOSED_CALCULATED, this.Parent.Parent[this.Channels].AVG_FOB_PREVIOUS_YEAR_CALCULATED, this.Parent.Parent[this.Channels].AVG_FOB_VS_PRIOR_YEAR_THRESHOLD.UOM)", ">=", "this.Parent.Parent[this.Channels].AVG_FOB_VS_PRIOR_YEAR_THRESHOLD[\\"Level 3\\"]", null, null, null, null, null, null, null, null, null, "Level3 Avg. full year Net FOB at Pricecat level is below Last Year"],["Level3", "ROLENAME", "this.Level==\\"Deal\\" &amp;&amp; getDiffByType(this.Proposed.Net_List_ATAX, this.Parent[this.Channels].MIN_NET_LIST_GUIDLINE, this.Parent[this.Channels].MIN_NETLIST_VS_GUIDANCE_THRESHOLD.UOM)", ">=", "this.Parent[this.Channels].MIN_NETLIST_VS_GUIDANCE_THRESHOLD[\\"Level 3\\"]", null, null, null, null, null, null, null, null, null, "Level3 NET List is below Min Net List guidance."],["Level3", "ROLENAME", "this.Level==\\"Deal\\" &amp;&amp; getDiffByType(this.Proposed.Net_FOB, this.Parent.Parent[this.Channels].MinCurrentNetFOB, this.Parent.Parent[this.Channels][\\"DEEPEST_FOB_THRESHOLD\\"].UOM)", ">=", "this.Parent.Parent[this.Channels][\\"DEEPEST_FOB_THRESHOLD\\"][\\"Level 3\\"]", null, null, null, null, null, null, null, null, null, "Level3 Proposed priceline is deeper (NET FOB) than any current."],["Level3", "ROLENAME", "this.Level==\\"Deal\\" &amp;&amp; getDiffByType(this.Proposed.Net_List_ATAX, this.Parent.Parent[this.Channels].MinCurrentNetList, this.Parent.Parent[this.Channels][\\"DEEPEST_NETLIST_THRESHOLD\\"].UOM)", ">=", "this.Parent.Parent[this.Channels][\\"DEEPEST_NETLIST_THRESHOLD\\"][\\"Level 3\\"]", null, null, null, null, null, null, null, null, null, "Level3 Proposed priceline is deeper Net List."],["Level3", "ROLENAME", "this.Level==\\"Deal\\" &amp;&amp; getDiffByType(this.Proposed.RAB, this.Parent[this.Channels].MIN_RAB_GUIDLINE, this.Parent[this.Channels].MIN_RAB_VS_GUIDANCE_THRESHOLD.UOM)", ">=", "this.Parent[this.Channels].MIN_RAB_VS_GUIDANCE_THRESHOLD[\\"Level 3\\"]", null, null, null, null, null, null, null, null, null, "Level3 Priceline RAB is below guidance"],["Level3", "ROLENAME", "this.Level==\\"Deal\\" &amp;&amp; getDiffByType(this.Parent.Parent[this.Channels].AVG_FOB_PROPOSED_CALCULATED, this.Parent.Parent[this.Channels].AVG_FOB_CURRENT_CALCULATED, this.Parent.Parent[this.Channels].AVG_FOB_DECREASE_THRESHOLD.UOM)", ">=", "this.Parent.Parent[this.Channels].AVG_FOB_DECREASE_THRESHOLD[\\"Level 3\\"]", null, null, null, null, null, null, null, null, null, "Level3 Current FOB comparison"],["Level3", "ROLENAME", "this.Level==\\"Summary\\" &amp;&amp; this.isPermissionCheckOnly", "==", "true", null, null, null, null, null, null, null, null, null, "By Pass Threshold"]]';


        var l_Admin = '[["Level1","ROLENAME",null,null,null,null,null,null,null,null,null,null,null,null,"ROLENAME"],["Level2", "ROLENAME", "this.Level==\\"Deal\\" &amp;&amp; getDiffByType(this.Proposed.Net_FOB, this.Parent[this.Channels].MIN_NET_FOB_GUIDLINE, this.Parent[this.Channels].MIN_FOB_VS_GUIDANCE_THRESHOLD.UOM)", ">=", "this.Parent[this.Channels].MIN_FOB_VS_GUIDANCE_THRESHOLD[\\"Level 2\\"]", null, null, null, null, null, null, null, null, null, "Level2 Priceline NET FOB is below Min FOB guidance"],["Level2", "ROLENAME", "this.Level==\\"Deal\\" &amp;&amp; getDiffByType(this.Parent.Parent[this.Channels].AVG_FOB_PROPOSED_CALCULATED, this.Parent.Parent[this.Channels].AVG_FOB_GUIDLINE, this.Parent.Parent[this.Channels].AVG_FOB_VS_GUIDANCE_THRESHOLD.UOM)", ">=", "this.Parent.Parent[this.Channels].AVG_FOB_VS_GUIDANCE_THRESHOLD[\\"Level 2\\"]", null, null, null, null, null, null, null, null, null, "Level2 Avg. full year Net FOB at Pricecat level is below Avg FOB guidance"],["Level2", "ROLENAME", "this.Level==\\"Deal\\" &amp;&amp; getDiffByType(this.Parent.Parent[this.Channels].AVG_FOB_PROPOSED_CALCULATED, this.Parent.Parent[this.Channels].AVG_FOB_PREVIOUS_YEAR_CALCULATED, this.Parent.Parent[this.Channels].AVG_FOB_VS_PRIOR_YEAR_THRESHOLD.UOM)", ">=", "this.Parent.Parent[this.Channels].AVG_FOB_VS_PRIOR_YEAR_THRESHOLD[\\"Level 2\\"]", null, null, null, null, null, null, null, null, null, "Level2 Avg. full year Net FOB at Pricecat level is below Last Year"],["Level2", "ROLENAME", "this.Level==\\"Deal\\" &amp;&amp; getDiffByType(this.Proposed.Net_List_ATAX, this.Parent[this.Channels].MIN_NET_LIST_GUIDLINE, this.Parent[this.Channels].MIN_NETLIST_VS_GUIDANCE_THRESHOLD.UOM)", ">=", "this.Parent[this.Channels].MIN_NETLIST_VS_GUIDANCE_THRESHOLD[\\"Level 2\\"]", null, null, null, null, null, null, null, null, null, "Level2 NET List is below Min Net List guidance."],["Level2", "ROLENAME", "this.Level==\\"Deal\\" &amp;&amp; getDiffByType(this.Proposed.Net_FOB, this.Parent.Parent[this.Channels].MinCurrentNetFOB, this.Parent.Parent[this.Channels][\\"DEEPEST_FOB_THRESHOLD\\"].UOM)", ">=", "this.Parent.Parent[this.Channels][\\"DEEPEST_FOB_THRESHOLD\\"][\\"Level 2\\"]", null, null, null, null, null, null, null, null, null, "Level2 Proposed priceline is deeper (NET FOB) than any current."],["Level2", "ROLENAME", "this.Level==\\"Deal\\" &amp;&amp; getDiffByType(this.Proposed.Net_List_ATAX, this.Parent.Parent[this.Channels].MinCurrentNetList, this.Parent.Parent[this.Channels][\\"DEEPEST_NETLIST_THRESHOLD\\"].UOM)", ">=", "this.Parent.Parent[this.Channels][\\"DEEPEST_NETLIST_THRESHOLD\\"][\\"Level 2\\"]", null, null, null, null, null, null, null, null, null, "Level2 Proposed priceline is deeper (NET FOB or Net List) than any current First condition."],["Level2", "ROLENAME", "this.Level==\\"Deal\\" &amp;&amp; getDiffByType(this.Proposed.RAB, this.Parent[this.Channels].MIN_RAB_GUIDLINE, this.Parent[this.Channels].MIN_RAB_VS_GUIDANCE_THRESHOLD.UOM)", ">=", "this.Parent[this.Channels].MIN_RAB_VS_GUIDANCE_THRESHOLD[\\"Level 2\\"]", null, null, null, null, null, null, null, null, null, "Level2 Priceline RAB is below guidance"],["Level2", "ROLENAME", "this.Level==\\"Deal\\" &amp;&amp; getDiffByType(this.Parent.Parent[this.Channels].AVG_FOB_PROPOSED_CALCULATED, this.Parent.Parent[this.Channels].AVG_FOB_CURRENT_CALCULATED, this.Parent.Parent[this.Channels].AVG_FOB_DECREASE_THRESHOLD.UOM)", ">=", "this.Parent.Parent[this.Channels].AVG_FOB_DECREASE_THRESHOLD[\\"Level 2\\"]", null, null, null, null, null, null, null, null, null, "Level2 Current FOB comparison"],["Level2", "ROLENAME", "this.Level==\\"Summary\\" &amp;&amp; this.isPermissionCheckOnly", "==", "true", null, null, null, null, null, null, null, null, null, "By Pass Threshold"],["Level3", "ROLENAME", "this.Level==\\"Deal\\" &amp;&amp; getDiffByType(this.Proposed.Net_FOB, this.Parent[this.Channels].MIN_NET_FOB_GUIDLINE, this.Parent[this.Channels].MIN_FOB_VS_GUIDANCE_THRESHOLD.UOM)", ">=", "this.Parent[this.Channels].MIN_FOB_VS_GUIDANCE_THRESHOLD[\\"Level 3\\"]", null, null, null, null, null, null, null, null, null, "Level3 Priceline NET FOB is below Min FOB guidance"],["Level3", "ROLENAME", "this.Level==\\"Deal\\" &amp;&amp; getDiffByType(this.Parent.Parent[this.Channels].AVG_FOB_PROPOSED_CALCULATED, this.Parent.Parent[this.Channels].AVG_FOB_GUIDLINE, this.Parent.Parent[this.Channels].AVG_FOB_VS_GUIDANCE_THRESHOLD.UOM)", ">=", "this.Parent.Parent[this.Channels].AVG_FOB_VS_GUIDANCE_THRESHOLD[\\"Level 3\\"]", null, null, null, null, null, null, null, null, null, "Level3 Avg. full year Net FOB at Pricecat level is below Avg FOB guidance"],["Level3", "ROLENAME", "this.Level==\\"Deal\\" &amp;&amp; getDiffByType(this.Parent.Parent[this.Channels].AVG_FOB_PROPOSED_CALCULATED, this.Parent.Parent[this.Channels].AVG_FOB_PREVIOUS_YEAR_CALCULATED, this.Parent.Parent[this.Channels].AVG_FOB_VS_PRIOR_YEAR_THRESHOLD.UOM)", ">=", "this.Parent.Parent[this.Channels].AVG_FOB_VS_PRIOR_YEAR_THRESHOLD[\\"Level 3\\"]", null, null, null, null, null, null, null, null, null, "Level3 Avg. full year Net FOB at Pricecat level is below Last Year"],["Level3", "ROLENAME", "this.Level==\\"Deal\\" &amp;&amp; getDiffByType(this.Proposed.Net_List_ATAX, this.Parent[this.Channels].MIN_NET_LIST_GUIDLINE, this.Parent[this.Channels].MIN_NETLIST_VS_GUIDANCE_THRESHOLD.UOM)", ">=", "this.Parent[this.Channels].MIN_NETLIST_VS_GUIDANCE_THRESHOLD[\\"Level 3\\"]", null, null, null, null, null, null, null, null, null, "Level3 NET List is below then Min Net List guidance."],["Level3", "ROLENAME", "this.Level==\\"Deal\\" &amp;&amp; getDiffByType(this.Proposed.Net_FOB, this.Parent.Parent[this.Channels].MinCurrentNetFOB, this.Parent.Parent[this.Channels][\\"DEEPEST_FOB_THRESHOLD\\"].UOM)", ">=", "this.Parent.Parent[this.Channels][\\"DEEPEST_FOB_THRESHOLD\\"][\\"Level 3\\"]", null, null, null, null, null, null, null, null, null, "Level3 Proposed priceline is deeper (NET FOB) than any current."],["Level3", "ROLENAME", "this.Level==\\"Deal\\" &amp;&amp; getDiffByType(this.Proposed.Net_List_ATAX, this.Parent.Parent[this.Channels].MinCurrentNetList, this.Parent.Parent[this.Channels][\\"DEEPEST_NETLIST_THRESHOLD\\"].UOM)", ">=", "this.Parent.Parent[this.Channels][\\"DEEPEST_NETLIST_THRESHOLD\\"][\\"Level 3\\"]", null, null, null, null, null, null, null, null, null, "Level3 Proposed priceline is deeper Net List than any current."],["Level3", "ROLENAME", "this.Level==\\"Deal\\" &amp;&amp; getDiffByType(this.Proposed.RAB, this.Parent[this.Channels].MIN_RAB_GUIDLINE, this.Parent[this.Channels].MIN_RAB_VS_GUIDANCE_THRESHOLD.UOM)", ">=", "this.Parent[this.Channels].MIN_RAB_VS_GUIDANCE_THRESHOLD[\\"Level 3\\"]", null, null, null, null, null, null, null, null, null, "Level3 Priceline RAB is below guidance"],["Level3", "ROLENAME", "this.Level==\\"Deal\\" &amp;&amp; getDiffByType(this.Parent.Parent[this.Channels].AVG_FOB_PROPOSED_CALCULATED, this.Parent.Parent[this.Channels].AVG_FOB_CURRENT_CALCULATED, this.Parent.Parent[this.Channels].AVG_FOB_DECREASE_THRESHOLD.UOM)", ">=", "this.Parent.Parent[this.Channels].AVG_FOB_DECREASE_THRESHOLD[\\"Level 3\\"]", null, null, null, null, null, null, null, null, null, "Level3 Current FOB comparison"],["Level3", "ROLENAME", "this.Level==\\"Summary\\" &amp;&amp; this.isPermissionCheckOnly", "==", "true", null, null, null, null, null, null, null, null, null, "By Pass Threshold"]]';

        var l_roleSplitArr = p_RoleName.split("-");
        var l_cust = l_roleSplitArr[0];

        if (l_cust == "AP3") {
            var regRoleName = RegExp(/ROLENAME/g);
            AP3 = AP3.replace(regRoleName, p_RoleName);
            return AP3;
        } else if (l_cust == "AP2") {
            var regRoleName = RegExp(/ROLENAME/g);
            AP2 = AP2.replace(regRoleName, p_RoleName);
            return AP2;
        } else if (l_cust == "AP1") {
            var regRoleName = RegExp(/ROLENAME/g);
            AP1 = AP1.replace(regRoleName, p_RoleName);
            return AP1;
        } else if (l_cust == "ADMIN" || l_cust == "Administrator") {
            var regRoleName = RegExp(/ROLENAME/g);
            l_Admin = l_Admin.replace(regRoleName, p_RoleName);
            return l_Admin;
        }
    } catch (err) {
        println('Failed to delete Ruleset ' + err);
    }
}

function addGeography(CreatorMatrixEntry, geog) {
    if (geog == "ALL GEOGRAPHY") {
        CreatorMatrixEntry[1] = "All Geography";
        CreatorMatrixEntry[2] = "All Geography";
    } else if (geog.charAt(0) == "S") {
        CreatorMatrixEntry[1] = "State";
        CreatorMatrixEntry[2] = geog;
    } else if (geog.charAt(0) == "R") {
        CreatorMatrixEntry[1] = "Region";
        CreatorMatrixEntry[2] = geog;
    } else {
        throw "GEOGRAPHY LEVEL is not supported";
    }
}

function addProduct(CreatorMatrixEntry, prod) {
    if (prod == "ALL") {
        CreatorMatrixEntry[3] = "All Product";
        CreatorMatrixEntry[4] = "All Product";
    } else {
        CreatorMatrixEntry[3] = "Business Unit";
        CreatorMatrixEntry[4] = prod;
    }
}

function addLevel(CreatorMatrixEntry, l_cust) {
    if (l_cust == "AP1") {
        CreatorMatrixEntry[6] = "Level1";
    } else if (l_cust == "AP2") {
        CreatorMatrixEntry[6] = "Level2";
    } else {
        CreatorMatrixEntry[6] = "Level3";
    }
}

function addRuleName(CreatorMatrixEntry, l_role) {
    var rgUnderscoe = RegExp(/-/g);
    var l_rulename = l_role.replace(rgUnderscoe, "_");
    l_rulename = l_rulename.replace("Geography", "Geo");
    CreatorMatrixEntry[9] = l_rulename + "_Ruleset";
}
</code></pre>
        </article>
    </section>




</div>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.4.2</a> on Thu Dec 01 2016 13:24:29 GMT+0530 (India Standard Time) using the <a href="https://github.com/clenemt/docdash">docdash</a> theme.
</footer>

<script>prettyPrint();</script>
<script src="scripts/linenumber.js"></script>
</body>
</html>
